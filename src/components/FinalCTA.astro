---
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import Headline from '~/components/ui/Headline.astro';
import Button from '~/components/ui/Button.astro';
---

<WidgetWrapper id="get-updates">
  <div class="rounded-2xl border border-gray-200/60 bg-white/90 px-6 py-8 text-center shadow-sm dark:border-slate-700/60 dark:bg-slate-900/70">
    <Headline
      title="Get updates on the launch."
      subtitle="Be the first to try Mowing Bidder when early access opens."
      classes={{ container: 'max-w-2xl mx-auto mb-6' }}
    />
    <div class="flex flex-col items-center justify-center gap-4 sm:flex-row">
      <Button type="button" variant="primary" text="Get Updates" data-open-updates />
      <a class="text-sm font-semibold text-primary hover:text-secondary" href="mailto:hello@example.com">
        Contact us
      </a>
    </div>
  </div>

  <dialog
    class="rounded-2xl border border-gray-200/60 bg-white p-6 text-left shadow-xl dark:border-slate-700/60 dark:bg-slate-900"
    data-updates-modal
  >
    <div class="max-w-md">
      <p class="text-lg font-semibold text-heading">Email signup coming soon.</p>
      <p class="mt-2 text-sm text-muted">Check back soon.</p>
      <div class="mt-6 flex justify-end">
        <Button type="button" variant="secondary" text="Close" data-close-updates />
      </div>
    </div>
  </dialog>
</WidgetWrapper>

<script>
  const openButton = document.querySelector('[data-open-updates]');
  const modal = document.querySelector('[data-updates-modal]');
  const closeButton = document.querySelector('[data-close-updates]');

  if (openButton && modal && closeButton) {
    openButton.addEventListener('click', () => {
      if (typeof modal.showModal === 'function') {
        modal.showModal();
      } else {
        modal.setAttribute('open', 'true');
      }
    });

    closeButton.addEventListener('click', () => {
      if (typeof modal.close === 'function') {
        modal.close();
      } else {
        modal.removeAttribute('open');
      }
    });

    modal.addEventListener('click', (event) => {
      if (event.target === modal) {
        if (typeof modal.close === 'function') {
          modal.close();
        } else {
          modal.removeAttribute('open');
        }
      }
    });
  }
</script>
